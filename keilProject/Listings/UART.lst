C51 COMPILER V9.54   UART                                                                  12/25/2025 21:12:47 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE UART
OBJECT MODULE PLACED IN .\Objects\UART.obj
COMPILER INVOKED BY: D:\IC_and_FPGA\MCU\stm32\Program\C51\BIN\C51.EXE ..\Codes\UART.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJ
                    -ECTEXTEND PRINT(.\Listings\UART.lst) OBJECT(.\Objects\UART.obj)

line level    source

   1          #include <REGX52.H>
   2          #include "UART.h"
   3          
   4          
   5          // 蓝牙芯片的RXD连接 51单片机 的P3.1(TXD)
   6          // 蓝牙芯片的TXD连接 51单片机 的P3.0(RXD)
   7          #define FOSC       12000000UL   
   8          #define UART_BAUD  9600         
   9          #define UART_SMOD  0            
  10          
  11          
  12          #if UART_SMOD==0
  13            #define TH1_RELOAD (256 - (FOSC/12/32/UART_BAUD))
  14          #else
                #define TH1_RELOAD (256 - (FOSC/12/16/UART_BAUD))
              #endif
  17          
  18          void UART_Init(void)
  19          {
  20   1          // 串口模式1，允许接收
  21   1          SCON = 0x50;        // SM0=0, SM1=1, REN=1
  22   1      
  23   1          // 设置 SMOD（波特率倍速）
  24   1          if (UART_SMOD) {
  25   2              PCON |= 0x80;   // SMOD = 1
  26   2          } else {
  27   2              PCON &= ~0x80;  // SMOD = 0
  28   2          }
  29   1      
  30   1          // Timer1 方式2（8位自动重装）作为波特率发生器
  31   1          TMOD = (TMOD & 0x0F) | 0x20; // 保留 Timer0，设置 Timer1 为方式2
  32   1      
  33   1          TH1 = (unsigned char)TH1_RELOAD;
  34   1          TL1 = (unsigned char)TH1_RELOAD;
  35   1      
  36   1          TR1 = 1;            // 启动 Timer1
  37   1      }
  38          
  39          void UART_SendByte(unsigned char Byte)
  40          {
  41   1          SBUF = Byte;
  42   1          while(!TI);
  43   1          TI = 0;
  44   1      }
  45          
  46          void UART_SendString(char *String)
  47          {
  48   1          unsigned int i = 0;
  49   1          while(String[i] != '\0')
  50   1          {
  51   2              UART_SendByte((unsigned char)String[i]);
  52   2              i++;
  53   2          }
  54   1      }
C51 COMPILER V9.54   UART                                                                  12/25/2025 21:12:47 PAGE 2   

*** WARNING C294 IN LINE 25 OF ..\Codes\UART.c: unreachable code


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     67    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
